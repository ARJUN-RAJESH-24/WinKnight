<Window x:Class="WinKnightUI.SettingsPopup"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="WinKnight Settings"
        Height="500" Width="600"
        WindowStartupLocation="CenterOwner"
        Background="#0B1A31"
        WindowStyle="None"
        ResizeMode="NoResize">
    
    <Window.Resources>
        <SolidColorBrush x:Key="BackgroundBrush" Color="#0B1A31"/>
        <SolidColorBrush x:Key="CardBackgroundBrush" Color="#182A41"/>
        <SolidColorBrush x:Key="AccentBlue" Color="#3498DB"/>
        <SolidColorBrush x:Key="FontPrimary" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="FontSecondary" Color="#8796A6"/>
        <SolidColorBrush x:Key="SuccessBrush" Color="#2ECC71"/>
        <SolidColorBrush x:Key="WarningBrush" Color="#F1C40F"/>
        <SolidColorBrush x:Key="ErrorBrush" Color="#E74C3C"/>

        <Style x:Key="SettingsCard" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource CardBackgroundBrush}"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Margin" Value="0,0,0,15"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="15" ShadowDepth="4" Opacity="0.2" Color="#000000"/>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SettingsToggle" TargetType="CheckBox">
            <Setter Property="Foreground" Value="{StaticResource FontPrimary}"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <Border x:Name="ToggleBorder" 
                                    Grid.Column="0"
                                    Width="50" 
                                    Height="24" 
                                    Background="#555555" 
                                    CornerRadius="12" 
                                    Margin="0,0,10,0">
                                <Ellipse x:Name="ToggleKnob" 
                                         HorizontalAlignment="Left" 
                                         VerticalAlignment="Center" 
                                         Width="20" 
                                         Height="20" 
                                         Margin="2" 
                                         Fill="White"/>
                            </Border>
                            
                            <ContentPresenter Grid.Column="1" 
                                              VerticalAlignment="Center"
                                              Margin="5,0,0,0"/>
                        </Grid>
                        
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="ToggleBorder" Property="Background" Value="{StaticResource AccentBlue}"/>
                                <Setter TargetName="ToggleKnob" Property="HorizontalAlignment" Value="Right"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SettingsButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource AccentBlue}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="20,10"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="8" 
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#5DADE2"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="DangerButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource ErrorBrush}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="20,10"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="8" 
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#EC7063"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Grid Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Text="Settings" 
                       Foreground="{StaticResource FontPrimary}" 
                       FontSize="24" 
                       FontWeight="Bold"
                       VerticalAlignment="Center"/>
            <Button x:Name="CloseButton" 
                    Content="Ã—" 
                    Width="30" 
                    Height="30" 
                    Background="Transparent" 
                    Foreground="{StaticResource FontPrimary}"
                    BorderThickness="0"
                    FontSize="16"
                    FontWeight="Bold"
                    HorizontalAlignment="Right"
                    Click="CloseButton_Click"/>
        </Grid>

        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- Appearance Settings -->
                <Border Style="{StaticResource SettingsCard}">
                    <StackPanel>
                        <TextBlock Text="Appearance" 
                                   Foreground="{StaticResource FontPrimary}" 
                                   FontSize="18" 
                                   FontWeight="SemiBold"
                                   Margin="0,0,0,10"/>
                        
                        <TextBlock Text="Theme"
                                   Foreground="{StaticResource FontSecondary}"
                                   FontSize="12"
                                   Margin="0,0,0,8"/>
                        
                        <!-- Theme Preset Buttons -->
                        <WrapPanel>
                            <Button x:Name="DarkThemeBtn" Content="ðŸŒ™ Dark" 
                                    Click="ThemePreset_Click" Tag="Dark"
                                    Margin="0,0,8,8" Padding="12,8"
                                    Background="#0B1A31" Foreground="White"
                                    BorderThickness="2" BorderBrush="#3498DB"/>
                            <Button x:Name="LightThemeBtn" Content="â˜€ï¸ Light" 
                                    Click="ThemePreset_Click" Tag="Light"
                                    Margin="0,0,8,8" Padding="12,8"
                                    Background="#F5F7FA" Foreground="#1A2332"
                                    BorderThickness="1" BorderBrush="#D6DDE5"/>
                            <Button x:Name="OceanThemeBtn" Content="ðŸŒŠ Ocean" 
                                    Click="ThemePreset_Click" Tag="Ocean"
                                    Margin="0,0,8,8" Padding="12,8"
                                    Background="#0D1B2A" Foreground="#E0FBFC"
                                    BorderThickness="1" BorderBrush="#00B4D8"/>
                            <Button x:Name="ForestThemeBtn" Content="ðŸŒ² Forest" 
                                    Click="ThemePreset_Click" Tag="Forest"
                                    Margin="0,0,8,8" Padding="12,8"
                                    Background="#1A1D21" Foreground="#E9ECEF"
                                    BorderThickness="1" BorderBrush="#28A745"/>
                            <Button x:Name="SunsetThemeBtn" Content="ðŸŒ… Sunset" 
                                    Click="ThemePreset_Click" Tag="Sunset"
                                    Margin="0,0,8,8" Padding="12,8"
                                    Background="#1A0F0F" Foreground="#FFF5F5"
                                    BorderThickness="1" BorderBrush="#FF6B35"/>
                            <Button x:Name="NordThemeBtn" Content="â„ï¸ Nord" 
                                    Click="ThemePreset_Click" Tag="Nord"
                                    Margin="0,0,8,8" Padding="12,8"
                                    Background="#2E3440" Foreground="#ECEFF4"
                                    BorderThickness="1" BorderBrush="#88C0D0"/>
                        </WrapPanel>
                        
                        <TextBlock Text="Click a theme to apply it instantly. Your preference will be saved."
                                   Foreground="{StaticResource FontSecondary}"
                                   FontSize="12"
                                   Margin="0,10,0,0"
                                   TextWrapping="Wrap"/>
                    </StackPanel>
                </Border>

                <!-- Windows Update Settings -->
                <Border Style="{StaticResource SettingsCard}">
                    <StackPanel>
                        <TextBlock Text="Windows Update" 
                                   Foreground="{StaticResource FontPrimary}" 
                                   FontSize="18" 
                                   FontWeight="SemiBold"
                                   Margin="0,0,0,10"/>
                        
                        <CheckBox x:Name="DisableWindowsUpdateToggle" 
                                  Style="{StaticResource SettingsToggle}"
                                  Content="Disable Windows Automatic Updates"
                                  Checked="DisableWindowsUpdateToggle_Checked"
                                  Unchecked="DisableWindowsUpdateToggle_Unchecked"/>
                        
                        <TextBlock Text="Prevents Windows from automatically downloading and installing updates."
                                   Foreground="{StaticResource FontSecondary}"
                                   FontSize="12"
                                   Margin="0,10,0,0"
                                   TextWrapping="Wrap"/>
                    </StackPanel>
                </Border>

                <!-- Startup Settings -->
                <Border Style="{StaticResource SettingsCard}">
                    <StackPanel>
                        <TextBlock Text="Startup Options" 
                                   Foreground="{StaticResource FontPrimary}" 
                                   FontSize="18" 
                                   FontWeight="SemiBold"
                                   Margin="0,0,0,10"/>
                        
                        <CheckBox x:Name="RunOnStartupToggle" 
                                  Style="{StaticResource SettingsToggle}"
                                  Content="Run WinKnight on System Startup"
                                  Checked="RunOnStartupToggle_Checked"
                                  Unchecked="RunOnStartupToggle_Unchecked"/>
                        
                        <CheckBox x:Name="RunAsAdminToggle" 
                                  Style="{StaticResource SettingsToggle}"
                                  Content="Always Run with Administrator Privileges"
                                  Checked="RunAsAdminToggle_Checked"
                                  Unchecked="RunAsAdminToggle_Unchecked"
                                  Margin="0,15,0,0"/>
                        
                        <TextBlock Text="Note: Administrator privileges are required for system repairs and restore points."
                                   Foreground="{StaticResource FontSecondary}"
                                   FontSize="12"
                                   Margin="0,10,0,0"
                                   TextWrapping="Wrap"/>
                    </StackPanel>
                </Border>

                <!-- Maintenance Settings -->
                <Border Style="{StaticResource SettingsCard}">
                    <StackPanel>
                        <TextBlock Text="Maintenance" 
                                   Foreground="{StaticResource FontPrimary}" 
                                   FontSize="18" 
                                   FontWeight="SemiBold"
                                   Margin="0,0,0,10"/>
                        
                        <Button x:Name="DeleteLogsButton" 
                                Content="Delete All Log Files" 
                                Style="{StaticResource DangerButton}"
                                Click="DeleteLogsButton_Click"
                                HorizontalAlignment="Left"/>
                        
                        <TextBlock Text="Permanently delete all application log files and scan reports."
                                   Foreground="{StaticResource FontSecondary}"
                                   FontSize="12"
                                   Margin="0,10,0,0"
                                   TextWrapping="Wrap"/>
                        
                        <Button x:Name="RevertChangesButton" 
                                Content="Revert All Changes" 
                                Style="{StaticResource DangerButton}"
                                Click="RevertChangesButton_Click"
                                HorizontalAlignment="Left"
                                Margin="0,15,0,0"/>
                        
                        <TextBlock Text="Revert all system changes made by WinKnight, including Windows Update settings and registry modifications."
                                   Foreground="{StaticResource FontSecondary}"
                                   FontSize="12"
                                   Margin="0,10,0,0"
                                   TextWrapping="Wrap"/>
                    </StackPanel>
                </Border>

                <!-- Application Info -->
                <Border Style="{StaticResource SettingsCard}">
                    <StackPanel>
                        <TextBlock Text="Application Information" 
                                   Foreground="{StaticResource FontPrimary}" 
                                   FontSize="18" 
                                   FontWeight="SemiBold"
                                   Margin="0,0,0,10"/>
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Version:" 
                                           Foreground="{StaticResource FontSecondary}"
                                           Margin="0,0,0,5"/>
                                <TextBlock Text="Build Date:" 
                                           Foreground="{StaticResource FontSecondary}"
                                           Margin="0,0,0,5"/>
                                <TextBlock Text="Log Location:" 
                                           Foreground="{StaticResource FontSecondary}"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="1" Margin="10,0,0,0">
                                <TextBlock x:Name="VersionText" 
                                           Text="1.0.0" 
                                           Foreground="{StaticResource FontPrimary}"
                                           Margin="0,0,0,5"/>
                                <TextBlock x:Name="BuildDateText" 
                                           Text="{Binding BuildDate}" 
                                           Foreground="{StaticResource FontPrimary}"
                                           Margin="0,0,0,5"/>
                                <TextBlock x:Name="LogLocationText" 
                                           Text="C:\ProgramData\WinKnight\Logs" 
                                           Foreground="{StaticResource FontPrimary}"
                                           TextWrapping="Wrap"/>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>

        <!-- Footer -->
        <Border Grid.Row="2" 
                Background="{StaticResource CardBackgroundBrush}" 
                CornerRadius="8" 
                Padding="15"
                Margin="0,15,0,0">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button x:Name="SaveButton" 
                        Content="Save Settings" 
                        Style="{StaticResource SettingsButton}"
                        Click="SaveButton_Click"
                        Margin="0,0,10,0"/>
                
                <Button x:Name="CancelButton" 
                        Content="Cancel" 
                        Style="{StaticResource SettingsButton}"
                        Background="Transparent"
                        Foreground="{StaticResource FontSecondary}"
                        Click="CancelButton_Click"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>